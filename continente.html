<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Viajes por Continente</title>
    <link rel="stylesheet" href="style/style_otros_rincones.css" />
    <link rel="stylesheet" href="style/style_continente.css" />
    <script src="script/translations.js" defer></script>
    <script src="script/script.js" defer></script>
</head>

<body>

    <header>
        <a href="home.html"><img src="images/logo.png" alt="Logotipo del sitio"></a>
        <h1 class="titulo" data-i18n="site-title">Mochileros sin fronteras</h1>
        <input type="checkbox" id="menu-toggle" class="menu-toggle">
        <label for="menu-toggle" class="hamburger-btn">
            <span class="bar"></span>
            <span class="bar"></span>
            <span class="bar"></span>
        </label>
        <nav class="nav-menu">
            <ul>
                <li><a href="home.html" data-i18n="nav-home">Inicio</a></li>
                <li><a href="otros_rincones.html" data-i18n="nav-otros">Otros rincones</a></li>
                <li><a href="blog.html" data-i18n="nav-blog">Blog</a></li>
                <li><a href="#" data-i18n="nav-cuenta">Mi cuenta</a></li>

                <li class="nav-utils">
                    <div class="logo_idioma_movil">
                        <img src="images/logo.png" alt="Logotipo del sitio">
                        <label for="idioma_movil" class="desplegable_idioma" data-i18n="language-label">Idioma</label>
                        <select id="idioma_movil">
                            <option>ES</option>
                            <option>EN</option>
                        </select>
                    </div>
                </li>
            </ul>
        </nav>

        <div class="logo_idioma">
            <label for="idioma" class="desplegable_idioma" data-i18n="language-label">Idioma</label>
            <select id="idioma">
                <option>ES</option>
                <option>EN</option>
            </select>
        </div>
    </header>

    <section class="columna-boton-atras-detalles">
        <button type="button" onclick="window.location.href='otros_rincones.html'">‚¨Ö</button>
    </section>

    <main>
        <h2 class="titulo-continente" id="titulo-continente">Europa</h2>

        <!-- Secci√≥n de Viajes -->
        <h3 class="subtitulo-seccion" data-i18n="continent-trips" id="subtitulo-viajes">Viajes organizados</h3>
        <div class="grid-viajes" id="grid-viajes">
            <!-- Los viajes se cargar√°n din√°micamente -->
        </div>

        <div class="mensaje-sin-viajes" id="mensaje-sin-viajes" style="display: none;">
            <p data-i18n="continent-no-trips">No hay viajes disponibles para esta regi√≥n.</p>
        </div>

        <!-- Secci√≥n de Ciudades Destacadas -->
        <h3 class="subtitulo-seccion" data-i18n="continent-cities" id="subtitulo-ciudades">Ciudades destacadas</h3>
        <div class="grid-ciudades" id="grid-ciudades">
            <!-- Las ciudades se cargar√°n din√°micamente -->
        </div>
    </main>

    <footer>
        <nav>
            <a href="ayuda.html" data-i18n="footer-help">Ayuda</a>
            <a href="contacto.html" data-i18n="footer-contact">Contacto</a>
            <a href="sobre_nosotros.html" data-i18n="footer-about">Sobre nosotros</a>
        </nav>
    </footer>

    <script>
        // Script para cargar viajes y ciudades del continente
        document.addEventListener('DOMContentLoaded', function () {
            const urlParams = new URLSearchParams(window.location.search);
            const continente = urlParams.get('region');

            if (!continente) {
                window.location.href = 'otros_rincones.html';
                return;
            }

            // Mapeo de nombres de continentes
            const nombresContinentes = {
                'norteamerica': { es: 'Am√©rica del Norte', en: 'North America' },
                'sudamerica': { es: 'Am√©rica del Sur', en: 'South America' },
                'europa': { es: 'Europa', en: 'Europe' },
                'africa': { es: '√Åfrica', en: 'Africa' },
                'asia': { es: 'Asia', en: 'Asia' },
                'oceania': { es: 'Ocean√≠a', en: 'Oceania' }
            };

            // Actualizar t√≠tulo
            const tituloElement = document.getElementById('titulo-continente');
            const idioma = getCurrentLanguage();
            if (nombresContinentes[continente]) {
                tituloElement.textContent = nombresContinentes[continente][idioma] || nombresContinentes[continente].es;
            }

            // ============ VIAJES ============
            const viajesFiltrados = viajes.filter(v => v.continente === continente);
            const gridViajes = document.getElementById('grid-viajes');
            const mensajeSinViajes = document.getElementById('mensaje-sin-viajes');
            const subtituloViajes = document.getElementById('subtitulo-viajes');

            if (viajesFiltrados.length === 0) {
                mensajeSinViajes.style.display = 'block';
                gridViajes.style.display = 'none';
                subtituloViajes.style.display = 'none';
            } else {
                // Generar tarjetas de viajes
                viajesFiltrados.forEach((viaje, index) => {
                    const titulo = idioma === 'en' && viaje.titulo_en ? viaje.titulo_en : viaje.titulo;
                    const guardado = estaGuardado(viaje);

                    const tarjeta = document.createElement('div');
                    tarjeta.className = 'tarjeta-viaje';
                    tarjeta.innerHTML = `
                        <div class="tarjeta-imagen">
                            <img src="${viaje.imagen}" alt="${titulo}">
                        </div>
                        <div class="tarjeta-info">
                            <h3>${viaje.destino}</h3>
                            <p class="tarjeta-titulo">${titulo}</p>
                            <p class="tarjeta-descripcion">${viaje.duracion} ${idioma === 'en' ? 'days' : 'd√≠as'} ¬∑ ${viaje.precio}‚Ç¨</p>
                        </div>
                        <div class="tarjeta-acciones">
                            <button class="btn-guardar ${guardado ? 'guardado' : ''}" title="${idioma === 'en' ? 'Save trip' : 'Guardar viaje'}">
                                <span>${guardado ? '‚ù§Ô∏è' : 'ü§ç'}</span> ${guardado ? (idioma === 'en' ? 'Saved' : 'Guardado') : (idioma === 'en' ? 'Save' : 'Guardar')}
                            </button>
                            <button class="btn-compartir" title="${idioma === 'en' ? 'Share' : 'Compartir'}">
                                <span>‚Üó</span> ${idioma === 'en' ? 'Share' : 'Compartir'}
                            </button>
                        </div>
                    `;

                    // Event listener para el bot√≥n guardar
                    const btnGuardar = tarjeta.querySelector('.btn-guardar');
                    btnGuardar.addEventListener('click', function (e) {
                        e.stopPropagation();
                        const ahora = guardarViaje(viaje);
                        // Actualizar el icono y texto
                        if (ahora) {
                            this.innerHTML = `<span>‚ù§Ô∏è</span> ${idioma === 'en' ? 'Saved' : 'Guardado'}`;
                            this.classList.add('guardado');
                        } else {
                            this.innerHTML = `<span>ü§ç</span> ${idioma === 'en' ? 'Save' : 'Guardar'}`;
                            this.classList.remove('guardado');
                        }
                    });

                    // Event listener para el bot√≥n compartir
                    const btnCompartir = tarjeta.querySelector('.btn-compartir');
                    btnCompartir.addEventListener('click', function (e) {
                        e.stopPropagation();
                        compartirViaje(viaje);
                    });

                    // Click en la tarjeta para ir a detalles
                    tarjeta.addEventListener('click', function (e) {
                        if (!e.target.closest('button')) {
                            localStorage.setItem('viajeSeleccionado', JSON.stringify(viaje));
                            localStorage.setItem('viajeOrigen', 'continente.html?region=' + continente);
                            window.location.href = 'detalles_viaje.html';
                        }
                    });

                    gridViajes.appendChild(tarjeta);
                });
            }

            // ============ CIUDADES ============
            const ciudadesFiltradas = ciudadesDelMundo.filter(c => c.continente === continente);
            const gridCiudades = document.getElementById('grid-ciudades');
            const subtituloCiudades = document.getElementById('subtitulo-ciudades');

            if (ciudadesFiltradas.length === 0) {
                subtituloCiudades.style.display = 'none';
                gridCiudades.style.display = 'none';
            } else {
                // Generar tarjetas de ciudades
                ciudadesFiltradas.forEach((ciudad) => {
                    const nombre = idioma === 'en' && ciudad.nombre_en ? ciudad.nombre_en : ciudad.nombre;
                    const pais = idioma === 'en' && ciudad.pais_en ? ciudad.pais_en : ciudad.pais;
                    const descripcion = idioma === 'en' && ciudad.descripcion_en ? ciudad.descripcion_en : ciudad.descripcion;

                    const tarjeta = document.createElement('div');
                    tarjeta.className = 'tarjeta-ciudad';
                    tarjeta.innerHTML = `
                        <div class="ciudad-imagen">
                            <img src="${ciudad.imagen}" alt="${nombre}" loading="lazy">
                        </div>
                        <div class="ciudad-info">
                            <h4>${nombre}</h4>
                            <p class="ciudad-pais">${pais}</p>
                            <p class="ciudad-descripcion">${descripcion}</p>
                        </div>
                    `;

                    gridCiudades.appendChild(tarjeta);
                });
            }
        });
    </script>
</body>

</html>